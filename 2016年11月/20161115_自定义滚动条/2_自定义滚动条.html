<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
<style>
#div1{
	width:30px;
	height: 300px;
	background: red;
	position: relative;
	
}
#div2{
	width:30px;
	height: 30px;
	background: #000;
	position: absolute;
	top:0;
	left:0;
}
#div3{
	height: 300px;
	width: 300px;
	background: green;
	position: absolute;
	left: 50px;
	top:8px;
	
}	
</style>
</head>
<body>
	<div id="div1">
		<div id="div2"></div>
	</div>
	<div id="div3"></div>
<script type="text/javascript">
	var div1 = document.getElementById('div1');
	var div2 = document.getElementById('div2');
	var div3 = document.getElementById('div3');
	
	div2.addEventListener('mousedown',fnDown);
	
	function fnDown(ev){
		var disY = ev.pageY - div2.offsetTop;
		document.addEventListener('mousemove',fnMove);
		document.addEventListener('mouseup',fnUp);
		function fnMove(ev){
			var t = ev.pageY - disY;
			if(t < 0){
				t = 0;
			}else if(t > div1.offsetHeight - div2.offsetHeight){
				t = div1.offsetHeight - div2.offsetHeight;
			}
			
			var scaleY = t/(div1.offsetHeight - div2.offsetHeight);
			
			div3.style.height = div3.style.width = (1-scaleY) * 300 + 'px';
			
			console.log(scaleY);
			
			div2.style.top = t + 'px';
		}
		function fnUp(){
			document.removeEventListener('mousemove',fnMove);
			document.removeEventListener('mouseup',fnUp);
		}
		ev.preventDefault();
	}
	
	
</script>
</body>
</html>